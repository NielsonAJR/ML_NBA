---
title: "Análise Exploratória de Dados"
lang: pt
message: false
warning: false
linkcolor: black
urlcolor: black
---


```{r}
#| echo: false

library(hoopR) # Banco de Dados
library(tidyverse) # Framework do tidyverse
library(tidymodels) # Framework de modelagem
library(skimr) # Estatística descritiva rápida
library(DataExplorer) # Exploração do conjunto de dados
library(corrplot) # Gráfico de correlação
library(GGally) # Gráficos adicionais com estrutura ggplot2
library(stringr) # Para lidar com strings
library(glmnet) # LASSO, Ridge e Rede Elástica
library(MASS) # Discriminante Linear (LDA) e Quadrático (RL)
library(recipes) # Pré-processamento dos dados
library(class) #knn
library(themis) # Balanceamento de dados
library(discrim) # lda, qda
library(kknn) # (Kernel) K-NN
library(finetune) # Otimização fina de hiperparâmetros
library(gt)
library(naivebayes)
library(knitr)
library(corrplot)


ggplot2::theme_set(theme_minimal()) # Ajustando Tema

dados_analise <- read.csv2("includes/nba.csv", sep = ";") 

dados_analise <- dados_analise |>
  mutate(
    across(c(PTS, AGE, AST, REB, OREB, DREB ,TOV, BLK, FG_PCT, FG3_PCT, FT_PCT), as.numeric),
    Position = as.factor(Position)
    )

```


## Estatísticas Descritivas


### Variáveis Numéricas

```{r}

dados_analise |>
  dplyr::select(AGE, PTS, AST, REB, OREB, DREB, TOV, STL, BLK , Peso, Altura) |> 
  summarise(across(
    everything(),
    list(
      Média   = ~mean(.x, na.rm = TRUE),
      Mediana = ~median(.x, na.rm = TRUE),
      SD      = ~sd(.x, na.rm = TRUE),
      Mín     = ~min(.x, na.rm = TRUE),
      Q1      = ~quantile(.x, 0.25, na.rm = TRUE),
      Q3      = ~quantile(.x, 0.75, na.rm = TRUE),
      Máx     = ~max(.x, na.rm = TRUE)
    ),
    .names = "{.col}_{.fn}"
  )) |>
  pivot_longer(
    cols = everything(),
    names_to = c("Variável", "Estatística"),
    names_sep = "_"
  ) |>
  pivot_wider(
    names_from = Variável,
    values_from = value
  ) |>
  kable(digits = 2, caption = "Resumo Estatístico dos Dados (per36)")



```

- As variáveis de desempenho apresentam heterogeneidade significativa, com amplitudes e desvios-padrão elevados em métricas como pontos, rebotes e assistências.

- A diferença entre média e mediana em algumas variáveis aponta para assimetria à direita (positiva) nas distribuições.


### Variáveis Categóricas

```{r}

table(dados_analise$Position) |>
  kable(col.names = c("Posição", "Frequência"))
 
```

- Revela um desbalanceamento moderado entre classes, com algumas posições sendo mais representadas do que outras.

- Esse cenário pode influenciar modelos de classificação supervisionada, favorecendo classes majoritárias.

## Visualização Gráfica

### Distribuição de idade

```{r}

ggplot(dados_analise, aes(x = AGE)) +
  geom_histogram(bins = 15, fill = "steelblue", color = "black") +
  labs(title = "Distribuição da Idade dos Jogadores",
       x = "Idade", y = "Frequência")

```



### Distribuição das posições

```{r}

ggplot(dados_analise, aes(x = Position)) +
  geom_bar(fill = "steelblue") +
  labs(
    title = "Distribuição das Posições dos Jogadores",
    x = "Posição",
    y = "Quantidade de Jogadores"
  )


```

- A distribuição etária dos jogadores mostra concentração em faixas específicas 

- O gráfico de distribuição por posição reforça a existência de diferenças estruturais entre os papéis exercidos em quadra, especialmente quando analisadas variáveis ofensivas e defensivas.

### Pontos por posição

```{r}

ggplot(dados_analise, aes(x = Position, y = PTS, fill = Position)) +
  geom_boxplot() +
  labs(title = "Distribuição de Pontos por Posição",
       x = "Posição", y = "Pontos")


```

- O Boxplot de pontuação evidenciam variações claras entre posições, tanto em termos de mediana quanto de dispersão.

- Algumas posições apresentam maior variabilidade ofensiva, enquanto outras mostram distribuições mais concentradas.

- Os resultados sugerem que a pontuação é uma variável relevante para a modelagem.


### Separabilidade entre posições

```{r}

ggplot(dados_analise, aes(x = AST, y = REB, color = Position)) +
  geom_point(alpha = 0.7) +
  labs(
    title = "Separabilidade entre Posições (Assistências vs Rebotes)",
    x = "Assistências",
    y = "Rebotes"
  )


```

- Sobreposição considerável entre posições, especialmente entre aquelas com funções híbridas.

- Esse comportamento sugere que relações multivariadas são mais informativas do que análises unidimensionais



### Eficiência no arremesso (FG%)

```{r}

ggplot(dados_analise, aes(x = FG_PCT)) +
  geom_histogram(bins = 15, fill = "darkgreen", color = "black") +
  labs(title = "Distribuição do FG%",
       x = "Field Goal %", y = "Frequência")

```

- Apresenta uma distribuição unimodal, com forte concentração em torno de valores intermediários (aproximadamente entre 0,40 e 0,55).

- Como também, apresenta assimetria leve, com cauda estendida para valores mais altos e alguns valores extremos (próximos a 0 ou 1).

## Correlação entre variáveis numéricas


```{r}



corrplot(
  cor(dados_analise %>% dplyr::select(AGE, PTS, AST, REB, OREB, DREB, TOV, STL, BLK, FG_PCT, FG3_PCT, FT_PCT, Altura, Peso), use = "complete.obs"),
  method = "color",
  tl.col = "black"
)


```

- A matriz de correlação evidencia associações moderadas a fortes entre algumas variáveis de desempenho, como métricas relacionadas à produção ofensiva e defensiva.


## Principais Insights da Análise Exploratória

- Não há separação clara entre posições com base em uma única variável, reforçando a necessidade de abordagens multivariadas.

- Existe sobreposição significativa entre posições adjacentes, o que justifica o estudo de conversão de posição e a modelagem baseada em perfis funcionais.

- Variáveis de volume (pontos, rebotes, assistências) apresentam maior poder discriminativo do que métricas de eficiência isoladas.

- O desbalanceamento entre classes pode influenciar os resultados da classificação, exigindo atenção na escolha de métricas e algoritmos.

- A análise reforça a hipótese central do estudo: posições tradicionais não formam grupos totalmente distintos no espaço estatístico, abrindo espaço para modelos que identifiquem papéis híbridos.


